language: python
matrix:
  include:
    # Use the built in venv for linux builds
    - os: linux
      sudo: required
      python: 2.7
      env: USE_FREETYPE=false
    - os: linux
      sudo: required
      python: 2.7
      env: USE_FREETYPE=true
    - os: linux
      sudo: required
      python: 3.4
      env: USE_FREETYPE=false
    - os: linux
      sudo: required
      python: 3.4
      env: USE_FREETYPE=true
    - os: linux
      sudo: required
      python: 3.5
      env: USE_FREETYPE=false
    - os: linux
      sudo: required
      python: 3.5
      env: USE_FREETYPE=true
    - os: linux
      sudo: required
      python: 3.6
      env: USE_FREETYPE=false
    - os: linux
      sudo: required
      python: 3.6
      env: USE_FREETYPE=true
    # Use generic language for osx
    - os: osx
      language: generic
      env: USE_FREETYPE=false USE_PYTHON=2
    - os: osx
      language: generic
      env: USE_FREETYPE=true USE_PYTHON=2
    - os: osx
      language: generic
      env: USE_FREETYPE=false USE_PYTHON=3
    - os: osx
      language: generic
      env: USE_FREETYPE=true USE_PYTHON=3
before_install:
  - if [[ "$TRAVIS_OS_NAME" ]] == "osx" ]]; then
        brew update;
        if [[ "$USE_PYTHON" == "2" ]]; then
            brew install python;
        else
            brew install python3;
        fi
install:
  - if [[ "$USE_FREETYPE" == "true" ]]; then
        if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
            sudo apt-get install freetype;
        else
            brew install freetype;
        fi
    fi
script:
 - python setup.py build_ext -i
 - python selftest.py